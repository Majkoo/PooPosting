<div class="m-4" @fadeIn>

  <form #form="ngForm" (ngSubmit)="onSubmit()">
    <div class="w-full pb-md flex-center">
      <img class="invert" src="../../../assets/logo/logo-row.png" alt="PooPosting" height="48" width="221"/>
    </div>
    <h2 class="title-large font-bolder text-center mb-lg">
      Sign Up to PooPost
    </h2>

    <div class="mb-3">
      <input
        type="text"
        class="input"
        placeholder="Username"
        name="nickname"
        #name="ngModel"
        [(ngModel)]="createAccountDto.nickname"
        [ngClass]="name.errors && name.touched && name.dirty ? 'border-warning' : 'border-grey'"
        required
        minlength="4"
        maxlength="16"
        pattern="^[a-zA-Z0-9_.-]+$"
      >
      <div
        class="text-warning dark:text-dark-warning opacity-75 px-sm mt-xs text-regular"
        [@errorAnimation]="name.touched && name.dirty ? 'visible' : 'hidden'"
      >

        <div
          [@errorAnimation]="name.errors && name.errors['required'] ? 'visible' : 'hidden'"
        >
          <span>Username is required</span>
        </div>

        <div
          [@errorAnimation]="name.errors && name.errors['pattern'] ? 'visible' : 'hidden'"
        >
          <span>Usernames cannot contain special characters</span>
        </div>

        <div
          [@errorAnimation]="name.errors && name.errors['minlength'] ? 'visible' : 'hidden'"
        >
          <span>Minimum username length is 4 characters</span>
        </div>

        <div
          [@errorAnimation]="name.errors && name.errors['maxlength'] ? 'visible' : 'hidden'"
        >
          <span>Maximum username length is 16 characters</span>
        </div>

      </div>
    </div>

    <div class="mb-3">
      <input
        type="email"
        class="input"
        placeholder="Email"
        name="email"
        #email="ngModel"
        [(ngModel)]="createAccountDto.email"
        [ngClass]="email.errors && email.touched && email.dirty ? 'border-warning' : 'border-grey'"
        required
        email
        maxlength="128"
      >
      <div
        class="text-warning dark:text-dark-warning opacity-75 px-sm mt-xs text-regular"
        [@errorAnimation]="email.touched && email.dirty ? 'visible' : 'hidden'"
      >

        <div
          [@errorAnimation]="email.errors && email.errors['required'] ? 'visible' : 'hidden'"
        >
          <span>Email is required</span>
        </div>

        <div
          [@errorAnimation]="email.errors && email.errors['email'] ? 'visible' : 'hidden'"
        >
          <span>Please provide a valid email</span>
        </div>

        <div
          [@errorAnimation]="email.errors && email.errors['maxlength'] ? 'visible' : 'hidden'"
        >
          <span>Maximum email length is 128 characters</span>
        </div>

      </div>
    </div>

    <div class="mb-3">
      <input
        type="password"
        class="input"
        placeholder="Password"
        name="password"
        #password="ngModel"
        [(ngModel)]="createAccountDto.password"
        [ngClass]="password.errors && password.touched && password.dirty ? 'border-warning' : 'border-grey'"
        required
        minlength="8"
        maxlength="128"
      >
      <div
        class="text-warning dark:text-dark-warning opacity-75 px-sm mt-xs text-regular"
        [@errorAnimation]="password.touched && password.dirty ? 'visible' : 'hidden'"
      >

        <div
          [@errorAnimation]="password.errors && password.errors['required'] ? 'visible' : 'hidden'"
        >
          <span>Password is required</span>
        </div>

        <div
          [@errorAnimation]="password.errors && password.errors['minlength'] ? 'visible' : 'hidden'"
        >
          <span>Minimum password length is 8 characters</span>
        </div>

        <div
          [@errorAnimation]="password.errors && password.errors['maxlength'] ? 'visible' : 'hidden'"
        >
          <span>Maximum password length is 128 characters</span>
        </div>

      </div>
    </div>

    <div class="mb-3">
      <input
        type="password"
        class="input"
        placeholder="Repeat password"
        name="confirmPassword"
        #confirmPassword="ngModel"
        [(ngModel)]="createAccountDto.confirmPassword"
        [ngClass]="confirmPassword.errors && confirmPassword.touched && confirmPassword.dirty ? 'border-warning' : 'border-grey'"
        required
        minlength="8"
        maxlength="128"
      >
      <div
        class="text-warning dark:text-dark-warning opacity-75 px-sm mt-xs text-regular"
        [@errorAnimation]="confirmPassword.touched && confirmPassword.dirty ? 'visible' : 'hidden'"
      >

        <div
          [@errorAnimation]="confirmPassword && confirmPassword.value !== password.value ? 'visible' : 'hidden'"
        >
          <span>Passwords should be the same</span>
        </div>

      </div>
    </div>

    <div class="text-center">

      <button
        class="px-20 py-md bg-cta-500 dark:dark-bg-cta-500 text-white font-bold mt-4 rounded-lg disabled:opacity-60"
        type="submit"
        [disabled]="form.invalid || awaitSubmit"
      >
        Register
      </button>

      <div
        class="my-md text-grey dark:text-dark-grey text-regular"
      >
        Already have an account?
        <a [routerLink]="['/login']" class="text-cta-500 dark:text-dark-cta">Log in</a>
      </div>

    </div>

    <div class="flex items-center justify-between mb-md">
      <div class="w-1/3 h-[1px] bg-grayscale-900 dark:dark-bg-grayscale-900"></div>
      <span class="title-small">OR</span>
      <div class="w-1/3 h-[1px] bg-grayscale-900 dark:dark-bg-grayscale-900"></div>
    </div>

    <pp-google-signin (loggedIn)="this.afterGoogleSignIn()"/>

  </form>

</div>
