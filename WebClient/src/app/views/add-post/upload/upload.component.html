<div
  class="w-full justify-center items-center flex border-4 rounded-xl border-dashed border-cta-500 bg-grayscale-500 dark:bg-dark-grayscale-500"
  [ngClass]="{
    'h-40': !rawFileUrl,
    'h-max': rawFileUrl,
    }"
  @fadeIn
>
  <!--  File Input  -->
  <div class="flex w-full" *ngIf="!rawFileUrl">
    <label
      for="fileInput"
      class="w-full flex justify-center items-center rounded-xl hover:blur-sm cursor-pointer transition duration-250 ease-in-out"
    >
      <p class="p-sm rounded-xl white-text text-bold">Upload a file...</p>
    </label>
    <input
      type="file"
      id="fileInput"
      class="hidden"
      [accept]="['image/*']"
      (change)="onFileChange($event.target)"
    />
  </div>

  <!--  Cropper -->
  <div *ngIf="rawFileUrl" class="rounded-xl relative flex flex-col">
    <div class="p-sm" (touchend)="cropperCrop()" (mouseover)="cropperCrop()">
      <angular-cropper
        #cropperComponent
        [imageUrl]="rawFileUrl"
        [cropperOptions]="{ aspectRatio: 3/4, viewMode: 2, responsive: true }"
        (ready)="onCropperReady()"
      />
    </div>
  </div>

</div>

<ng-container *ngIf="rawFileUrl">
  <!--    aspect ratio buttons  -->
  <div class="flex flex-col my-3">
    <div class="p-sm pb-0">
      <p class="title-large text-center">Choose aspect ratio</p>
    </div>
    <div class="flex gap-md p-sm pb-0 items-center justify-center flex-wrap">
      <button
        class="px-sm py-xs rounded-lg text-regular white-text md:px-md md:py-sm"
        [ngClass]="aspectRatio == 3 / 4 ? 'bg-cta-500 dark:dark-bg-cta' : 'bg-primary-800 dark:bg-dark-primary-800'"
        (click)="changeAspectRatio(3 / 4)"
        [disabled]="!this.rawFileUrl"
      >
        3/4
      </button>
      <button
        class="px-sm py-xs rounded-lg text-regular white-text md:px-md md:py-sm"
        [ngClass]="aspectRatio == 4 / 4 ? 'bg-cta-500 dark:dark-bg-cta' : 'bg-primary-800 dark:bg-dark-primary-800'"
        (click)="changeAspectRatio(4 / 4)"
        [disabled]="!this.rawFileUrl"
      >
        4/4
      </button>
      <button
        class="px-sm py-xs rounded-lg text-regular white-text md:px-md md:py-sm"
        [ngClass]="aspectRatio == 4/3 ? 'bg-cta-500 dark:dark-bg-cta' : 'bg-primary-800 dark:bg-dark-primary-800'"
        (click)="changeAspectRatio(4 / 3)"
        [disabled]="!this.rawFileUrl"
      >
        4/3
      </button>
      <button
        class="px-sm py-xs rounded-lg text-regular white-text md:px-md md:py-sm"
        [ngClass]="aspectRatio == 4 / 2 ? 'bg-cta-500 dark:dark-bg-cta' : 'bg-primary-800 dark:bg-dark-primary-800'"
        (click)="changeAspectRatio(4 / 2)"
        [disabled]="!this.rawFileUrl"
      >
        4/2
      </button>
    </div>
  </div>

  <div class="flex flex-col text-center w-full my-4 border-t-2 justify-center items-center gap-md flex-wrap"></div>

</ng-container>

<div class="mt-3 flex items-between justify-between">
  <button
    @fadeIn
    class="flex gap-xs text-regular white-text px-md py-sm rounded-lg whitespace-nowrap bg-primary-800 dark:bg-dark dark:bg-dark-dark-primary-800 disabled:opacity-60"
    [disabled]="!rawFileUrl"
    (click)="reset()"
  >
    Reset
  </button>

  <div class="flex items-end gap-md">
    <button
      @fadeIn
      class="flex gap-xs text-regular white-text px-md py-sm rounded-lg whitespace-nowrap bg-cta-500 dark:dark-bg-cta-500 disabled:opacity-60"
      [disabled]="!canProceed"
      (click)="goNext()"
    >
      Next step
    </button>
  </div>
</div>
